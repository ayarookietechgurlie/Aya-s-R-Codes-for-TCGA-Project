#library download line 
if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
BiocManager::install(c("TCGAbiolinks", "tidyverse", "maftools", "pheatmap", "SummarizedExperiment", "sesameData", "sesame"))

#load installed libraries
library(TCGAbiolinks)
library(tidyverse)
library(maftools)
library(pheatmap)
library(SummarizedExperiment)
library(sesameData)
library(sesame)

#list of projects 
gdcprojects <- getGDCprojects()

#build first query 
query_methylGBM <- GDCquery(project = 'TCGA-GBM',
                             data.category = 'DNA Methylation',
                             platform = 'Illumina Human Methylation 450',
                             access = 'open',
                             data.type = 'Methylation Beta Value',
                             barcode = c("TCGA-06-0190-02A-01D-2004-05",
                                         "TCGA-14-1395-01B-11D-1844-05",
                                         "TCGA-76-4931-01A-01D-1481-05",
                                         "TCGA-76-4926-01B-01D-1481-05",
                                         "TCGA-28-5220-01A-01D-1481-05",
                                         "TCGA-76-6191-01A-12D-1697-05",
                                         "TCGA-26-6174-01A-21D-1844-05",
                                         "TCGA-74-6578-01A-11D-1844-05",
                                         "TCGA-26-6173-01A-11D-1844-05",
                                         "TCGA-19-5951-01A-11D-1697-05",
                                         "TCGA-74-6575-01A-11D-1844-05",
                                         "TCGA-19-5958-01A-11D-1697-05",
                                         "TCGA-19-A6J4-01A-11D-A33U-05",
                                         "TCGA-41-6646-01A-11D-1844-05",
                                         "TCGA-06-6390-01A-11D-1697-05",
                                         "TCGA-06-0650-01A-02D-1697-05",
                                         "TCGA-06-0190-01A-01D-A45W-05",
                                         "TCGA-06-6388-01A-12D-1844-05",
                                         "TCGA-74-6573-01A-12D-1844-05",
                                         "TCGA-76-4925-01A-01D-1481-05",
                                         "TCGA-06-6391-01A-11D-1697-05",
                                         "TCGA-4W-AA9T-01A-11D-A392-05",
                                         "TCGA-76-6193-01A-11D-1697-05",
                                         "TCGA-06-5408-01A-01D-1697-05",
                                         "TCGA-81-5910-01A-11D-1697-05",
                                         "TCGA-76-4927-01A-01D-1481-05",
                                         "TCGA-26-5135-01A-01D-1481-05",
                                         "TCGA-06-5417-01A-01D-1481-05",
                                         "TCGA-19-0957-01C-01D-A45W-05",
                                         "TCGA-06-0125-02A-11D-2004-05",
                                         "TCGA-14-1043-01B-11D-1844-05",
                                         "TCGA-19-4065-01A-01D-2004-05",
                                         "TCGA-19-5955-01A-11D-1697-05",
                                         "TCGA-06-1806-01A-02D-1844-05",
                                         "TCGA-06-6697-01A-11D-1844-05",
                                         "TCGA-28-5209-01A-01D-1481-05",
                                         "TCGA-26-5134-01A-01D-1481-05",
                                         "TCGA-OX-A56R-01A-11D-A33U-05",
                                         "TCGA-06-6701-01A-11D-1844-05",
                                         "TCGA-19-5947-01A-11D-1697-05",
                                         "TCGA-19-5954-01A-11D-1697-05",
                                         "TCGA-26-5132-01A-01D-1481-05",
                                         "TCGA-14-0862-01B-01D-1844-05",
                                         "TCGA-12-5301-01A-01D-1481-05",
                                         "TCGA-RR-A6KA-01A-21D-A33U-05",
                                         "TCGA-06-AABW-11A-31D-A368-05",
                                         "TCGA-28-5204-01A-01D-1481-05",
                                         "TCGA-RR-A6KC-01A-31D-A33U-05",
                                         "TCGA-06-5859-01A-01D-1697-05",
                                         "TCGA-06-5418-01A-01D-1481-05",
                                         "TCGA-28-5208-01A-01D-1481-05",
                                         "TCGA-06-A7TK-01A-21D-A392-05",
                                         "TCGA-06-A5U0-01A-11D-A33U-05",
                                         "TCGA-76-6286-01A-11D-1844-05",
                                         "TCGA-76-6661-01B-11D-1844-05",
                                         "TCGA-19-1389-02A-21D-2004-05",
                                         "TCGA-74-6581-01A-11D-1844-05",
                                         "TCGA-06-6700-01A-12D-1844-05",
                                         "TCGA-15-1444-01A-02D-1697-05",
                                         "TCGA-26-A7UX-01B-11D-A392-05",
                                         "TCGA-06-5416-01A-01D-1481-05",
                                         "TCGA-19-1389-01A-01D-A45W-05",
                                         "TCGA-26-1442-01A-01D-1697-05",
                                         "TCGA-14-1402-02A-01D-2004-05",
                                         "TCGA-12-5295-01A-01D-1481-05",
                                         "TCGA-41-5651-01A-01D-1697-05",
                                         "TCGA-76-6282-01A-11D-1697-05",
                                         "TCGA-32-1980-01A-01D-1697-05",
                                         "TCGA-06-A6S0-01A-11D-A33U-05",
                                         "TCGA-06-5410-01A-01D-1697-05",
                                         "TCGA-06-6694-01A-12D-1844-05",
                                         "TCGA-74-6573-11A-02D-1844-05",
                                         "TCGA-28-6450-01A-11D-1697-05",
                                         "TCGA-19-A6J5-01A-21D-A33U-05",
                                         "TCGA-06-5415-01A-01D-1481-05",
                                         "TCGA-76-6664-01A-11D-1844-05",
                                         "TCGA-76-6663-01A-11D-1844-05",
                                         "TCGA-06-6699-01A-11D-1844-05",
                                         "TCGA-28-5214-01A-01D-1481-05",
                                         "TCGA-14-0736-02A-01D-2004-05",
                                         "TCGA-14-0736-01A-01D-A45W-05",
                                         "TCGA-28-5215-01A-01D-1481-05",
                                         "TCGA-76-4934-01A-01D-1481-05",
                                         "TCGA-06-6693-01A-11D-1844-05",
                                         "TCGA-74-6577-01A-11D-1844-05",
                                         "TCGA-19-4065-02A-11D-2004-05",
                                         "TCGA-28-2501-01A-01D-1697-05",
                                         "TCGA-14-0781-01B-01D-1697-05",
                                         "TCGA-76-6285-01A-11D-1697-05",
                                         "TCGA-76-4935-01A-01D-1481-05",
                                         "TCGA-19-5956-01A-11D-1697-05",
                                         "TCGA-76-6656-01A-11D-1844-05",
                                         "TCGA-14-0740-01B-01D-1844-05",
                                         "TCGA-06-5413-01A-01D-1697-05",
                                         "TCGA-76-6662-01A-11D-1844-05",
                                         "TCGA-06-5414-01A-01D-1481-05",
                                         "TCGA-87-5896-01A-01D-1697-05",
                                         "TCGA-26-5139-01A-01D-1481-05",
                                         "TCGA-06-0152-02A-01D-2004-05",
                                         "TCGA-06-5856-01A-01D-1697-05",
                                         "TCGA-4W-AA9R-01A-11D-A392-05",
                                         "TCGA-06-0152-01A-02D-A45W-05",
                                         "TCGA-06-0210-01A-01D-A45W-05",
                                         "TCGA-06-6389-01A-11D-1697-05",
                                         "TCGA-76-4928-01B-01D-1481-05",
                                         "TCGA-14-1450-01B-01D-1844-05",
                                         "TCGA-19-A60I-01A-12D-A33U-05",
                                         "TCGA-32-5222-01A-01D-1481-05",
                                         "TCGA-06-5412-01A-01D-1697-05",
                                         "TCGA-28-5207-01A-01D-1481-05",
                                         "TCGA-19-5952-01A-11D-1697-05",
                                         "TCGA-76-6283-01A-11D-1844-05",
                                         "TCGA-76-4932-01A-01D-1481-05",
                                         "TCGA-28-5211-01C-11D-1844-05",
                                         "TCGA-26-5136-01B-01D-1481-05",
                                         "TCGA-06-0171-02A-11D-2004-05",
                                         "TCGA-06-5411-01A-01D-1697-05",
                                         "TCGA-76-6657-01A-11D-1844-05",
                                         "TCGA-76-6660-01A-11D-1844-05",
                                         "TCGA-06-0171-01A-02D-A45W-05",
                                         "TCGA-14-1402-01A-01D-A45W-05",
                                         "TCGA-28-5216-01A-01D-1481-05",
                                         "TCGA-76-4929-01A-01D-1481-05",
                                         "TCGA-06-6698-01A-11D-1844-05",
                                         "TCGA-28-5218-01A-01D-1481-05",
                                         "TCGA-06-1804-01A-01D-1697-05",
                                         "TCGA-19-5960-01A-11D-1697-05",
                                         "TCGA-19-0957-02A-11D-2004-05",
                                         "TCGA-06-0125-01A-01D-A45W-05",
                                         "TCGA-19-5953-01B-12D-1844-05",
                                         "TCGA-26-5133-01A-01D-1481-05",
                                         "TCGA-06-5858-01A-01D-1697-05",
                                         "TCGA-06-A6S1-01A-11D-A33U-05",
                                         "TCGA-19-5950-01A-11D-1697-05",
                                         "TCGA-06-0210-02A-01D-2004-05",
                                         "TCGA-74-6584-01A-11D-1844-05",
                                         "TCGA-28-5219-01A-01D-1481-05",
                                         "TCGA-28-2510-01A-01D-1697-05",
                                         "TCGA-06-0211-02A-02D-2004-05",
                                         "TCGA-76-6192-01A-11D-1697-05",
                                         "TCGA-12-5299-01A-02D-1481-05",
                                         "TCGA-76-6280-01A-21D-1844-05",
                                         "TCGA-4W-AA9S-01A-11D-A392-05",
                                         "TCGA-06-A5U1-01A-11D-A33U-05",
                                         "TCGA-19-5959-01A-11D-1697-05",
                                         "TCGA-06-0211-01A-01D-A45W-05",
                                         "TCGA-RR-A6KB-01A-12D-A33U-05",
                                         "TCGA-28-5213-01A-01D-1481-05",
                                         "TCGA-06-0221-01A-01D-A45W-05",
                                         "TCGA-06-0221-02A-11D-2004-05",
                                         "TCGA-06-A7TL-01A-11D-A392-05",
                                         "TCGA-32-1979-01A-01D-1697-05",
                                         "TCGA-14-1034-02B-01D-2004-05",
                                         "TCGA-81-5911-01A-12D-1844-05",
                                         "TCGA-06-6695-01A-11D-1844-05"))


#download data 
output_querymethylGBM <- getResults(query_methylCOAD)
GDCdownload(query_methylGBM)

#data prepare and assay
GBMDM100 <- GDCprepare(query_methylGBM, summarizedExperiment = TRUE)
assay(GBMDM100)

#final file download 
write.csv(assay(GBMDM100), file = "TCGA-GBMDNAMethFINAL.csv")