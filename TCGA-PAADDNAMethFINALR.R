#library download line 
if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
BiocManager::install(c("TCGAbiolinks", "tidyverse", "maftools", "pheatmap", "SummarizedExperiment", "sesameData", "sesame"))

#load installed libraries
library(TCGAbiolinks)
library(tidyverse)
library(maftools)
library(pheatmap)
library(SummarizedExperiment)
library(sesameData)
library(sesame)

#list of projects 
gdcprojects <- getGDCprojects()

#build first query 
query_methylPAAD <- GDCquery(project = 'TCGA-PAAD',
                             data.category = 'DNA Methylation',
                             platform = 'Illumina Human Methylation 450',
                             access = 'open',
                             data.type = 'Methylation Beta Value',
                             barcode = c("TCGA-IB-7897-01A-21D-2202-05",
                                         "TCGA-HV-A5A5-01A-11D-A26Q-05",
                                         "TCGA-FB-AAPP-01A-12D-A40Y-05",
                                         "TCGA-HZ-7289-01A-11D-2157-05",
                                         "TCGA-HZ-8005-01A-11D-2202-05",
                                         "TCGA-HZ-7920-01A-11D-2202-05",
                                         "TCGA-HZ-A49I-01A-12D-A26Q-05",
                                         "TCGA-FB-AAPS-01A-12D-A398-05",
                                         "TCGA-FB-A78T-01A-12D-A32S-05",
                                         "TCGA-HZ-7926-01A-11D-2157-05",
                                         "TCGA-IB-7888-01A-11D-2157-05",
                                         "TCGA-2J-AABT-01A-11D-A40Y-05",
                                         "TCGA-US-A779-01A-11D-A32S-05",
                                         "TCGA-FZ-5924-01A-13D-1744-05",
                                         "TCGA-FZ-5924-11A-01D-1744-05",
                                         "TCGA-HZ-A4BK-01A-11D-A26Q-05",
                                         "TCGA-IB-A6UF-01A-23D-A33U-05",
                                         "TCGA-US-A77E-01A-11D-A32S-05",
                                         "TCGA-IB-AAUR-01A-21D-A38H-05",
                                         "TCGA-Z5-AAPL-01A-12D-A40Y-05",
                                         "TCGA-F2-A8YN-01A-11D-A378-05",
                                         "TCGA-2J-AAB1-01A-11D-A40Y-05",
                                         "TCGA-IB-AAUS-01A-12D-A38H-05",
                                         "TCGA-IB-AAUT-01A-11D-A378-05",
                                         "TCGA-H6-8124-01A-11D-2399-05",
                                         "TCGA-FZ-5923-01A-12D-1744-05",
                                         "TCGA-3A-A9J0-01A-11D-A40Y-05",
                                         "TCGA-XD-AAUI-01A-42D-A40Y-05",
                                         "TCGA-HZ-A9TJ-06A-11D-A40Y-05",
                                         "TCGA-FZ-5920-01A-11D-1744-05",
                                         "TCGA-2J-AAB9-01A-11D-A40Y-05",
                                         "TCGA-S4-A8RM-01A-11D-A378-05",
                                         "TCGA-IB-7646-01A-11D-2157-05",
                                         "TCGA-IB-7891-01A-11D-2202-05",
                                         "TCGA-LB-A8F3-01A-11D-A368-05",
                                         "TCGA-HZ-7925-01A-11D-2157-05",
                                         "TCGA-FB-AAPQ-01A-11D-A40Y-05",
                                         "TCGA-YY-A8LH-01A-11D-A368-05",
                                         "TCGA-2L-AAQJ-01A-12D-A398-05",
                                         "TCGA-HZ-A77O-01A-11D-A33U-05",
                                         "TCGA-FZ-5919-11A-02D-1744-05",
                                         "TCGA-FB-AAQ1-01A-12D-A40Y-05",
                                         "TCGA-FB-AAQ2-01A-31D-A40Y-05",
                                         "TCGA-IB-AAUW-01A-12D-A38H-05",
                                         "TCGA-HZ-A49H-01A-11D-A26Q-05",
                                         "TCGA-Q3-AA2A-01A-11D-A378-05",
                                         "TCGA-Q3-A5QY-01A-12D-A32S-05",
                                         "TCGA-F2-A7TX-01A-33D-A38H-05",
                                         "TCGA-IB-7644-01A-11D-2157-05",
                                         "TCGA-IB-A5SS-01A-11D-A32S-05",
                                         "TCGA-LB-A9Q5-01A-11D-A398-05",
                                         "TCGA-US-A77J-01A-11D-A32S-05",
                                         "TCGA-2J-AAB4-01A-12D-A40Y-05",
                                         "TCGA-HZ-A49G-01A-11D-A26Q-05",
                                         "TCGA-IB-7651-01A-11D-2157-05",
                                         "TCGA-HZ-8002-01A-11D-2202-05",
                                         "TCGA-IB-A5SQ-01A-11D-A32S-05",
                                         "TCGA-IB-7890-01A-12D-2202-05",
                                         "TCGA-3A-A9I7-01A-21D-A38H-05",
                                         "TCGA-FB-AAQ3-01A-11D-A40Y-05",
                                         "TCGA-HZ-7923-01A-12D-2157-05",
                                         "TCGA-HZ-8638-01A-11D-2399-05",
                                         "TCGA-F2-A44H-01A-11D-A26Q-05",
                                         "TCGA-HV-A7OP-01A-11D-A33U-05",
                                         "TCGA-US-A77G-01A-11D-A32S-05",
                                         "TCGA-H6-A45N-01A-11D-A26Q-05",
                                         "TCGA-IB-AAUO-01A-12D-A38H-05",
                                         "TCGA-H6-A45N-11A-12D-A26Q-05",
                                         "TCGA-FB-AAPU-01A-31D-A40Y-05",
                                         "TCGA-2J-AABF-01A-31D-A40Y-05",
                                         "TCGA-IB-7645-01A-22D-2202-05",
                                         "TCGA-2L-AAQM-01A-11D-A398-05",
                                         "TCGA-3A-A9IX-01A-11D-A40Y-05",
                                         "TCGA-FZ-5923-11A-01D-1744-05",
                                         "TCGA-HZ-A8P0-01A-11D-A368-05",
                                         "TCGA-FB-AAQ0-01A-31D-A40Y-05",
                                         "TCGA-3A-A9I5-01A-11D-A38H-05",
                                         "TCGA-2J-AABP-01A-11D-A40Y-05",
                                         "TCGA-FB-A4P6-01A-12D-A26Q-05",
                                         "TCGA-HZ-A9TJ-01A-11D-A40Y-05",
                                         "TCGA-FZ-5922-11A-01D-1744-05",
                                         "TCGA-FZ-5922-01A-11D-1744-05",
                                         "TCGA-IB-AAUQ-01A-22D-A40Y-05",
                                         "TCGA-FZ-5920-11A-01D-1744-05",
                                         "TCGA-PZ-A5RE-01A-11D-A32S-05",
                                         "TCGA-3E-AAAY-01A-11D-A38H-05",
                                         "TCGA-HZ-A8P1-01A-11D-A378-05",
                                         "TCGA-XN-A8T3-01A-11D-A368-05",
                                         "TCGA-US-A776-01A-13D-A33U-05",
                                         "TCGA-HZ-A77Q-01A-11D-A368-05",
                                         "TCGA-XD-AAUG-01A-61D-A40Y-05",
                                         "TCGA-2J-AABI-01A-12D-A40Y-05",
                                         "TCGA-IB-7889-01A-11D-2157-05",
                                         "TCGA-IB-7893-01A-11D-2202-05",
                                         "TCGA-HV-A5A4-01A-11D-A26Q-05",
                                         "TCGA-3A-A9IB-01A-21D-A398-05",
                                         "TCGA-3A-A9IR-01A-11D-A38H-05",
                                         "TCGA-HZ-8637-01A-11D-2399-05",
                                         "TCGA-2J-AABE-01A-12D-A40Y-05",
                                         "TCGA-YH-A8SY-01A-11D-A378-05",
                                         "TCGA-HZ-7918-01A-11D-2157-05",
                                         "TCGA-IB-AAUN-01A-12D-A38H-05",
                                         "TCGA-IB-AAUV-01A-11D-A38H-05",
                                         "TCGA-IB-7654-01A-11D-2157-05",
                                         "TCGA-IB-A7M4-01A-11D-A368-05",
                                         "TCGA-FZ-5926-11A-01D-1744-05",
                                         "TCGA-3A-A9IJ-01A-11D-A398-05",
                                         "TCGA-FZ-5926-01A-11D-1744-05",
                                         "TCGA-HZ-7922-01A-11D-2157-05",
                                         "TCGA-HZ-8003-01A-21D-2202-05",
                                         "TCGA-2J-AAB6-01A-11D-A40Y-05",
                                         "TCGA-FB-AAQ6-01A-11D-A40Y-05",
                                         "TCGA-H6-8124-11A-01D-2399-05",
                                         "TCGA-2L-AAQE-01A-11D-A398-05",
                                         "TCGA-2L-AAQI-01A-12D-A398-05",
                                         "TCGA-RL-AAAS-01A-32D-A398-05",
                                         "TCGA-HZ-8317-01A-11D-2399-05",
                                         "TCGA-XD-AAUH-01A-42D-A40Y-05",
                                         "TCGA-3A-A9IS-01A-21D-A398-05",
                                         "TCGA-S4-A8RO-01A-12D-A378-05",
                                         "TCGA-F2-6880-01A-11D-2157-05",
                                         "TCGA-L1-A7W4-01A-12D-A368-05",
                                         "TCGA-YB-A89D-01A-12D-A368-05",
                                         "TCGA-HZ-7924-01A-11D-2157-05",
                                         "TCGA-IB-A5SP-01A-11D-A32S-05",
                                         "TCGA-2J-AABA-01A-21D-A40Y-05",
                                         "TCGA-2J-AABK-01A-31D-A40Y-05",
                                         "TCGA-HV-AA8X-01A-11D-A398-05",
                                         "TCGA-2L-AAQL-01A-11D-A38H-05",
                                         "TCGA-3A-A9IL-01A-11D-A38H-05",
                                         "TCGA-HZ-7919-01A-11D-2157-05",
                                         "TCGA-HZ-8315-01A-11D-2399-05",
                                         "TCGA-XN-A8T5-01A-12D-A368-05",
                                         "TCGA-3A-A9I9-01A-11D-A38H-05",
                                         "TCGA-US-A774-01A-21D-A32S-05",
                                         "TCGA-HZ-A4BH-01A-11D-A26Q-05",
                                         "TCGA-H8-A6C1-01A-11D-A32S-05",
                                         "TCGA-IB-AAUP-01A-11D-A378-05",
                                         "TCGA-3A-A9IZ-01A-12D-A40Y-05",
                                         "TCGA-2J-AABU-01A-11D-A40Y-05",
                                         "TCGA-HV-A5A6-01A-11D-A26Q-05",
                                         "TCGA-F2-7273-01A-11D-2157-05",
                                         "TCGA-IB-8126-01A-11D-2399-05",
                                         "TCGA-HZ-8001-01A-11D-2202-05",
                                         "TCGA-2J-AABR-01A-11D-A40Y-05",
                                         "TCGA-HZ-A77P-01A-11D-A33U-05",
                                         "TCGA-XD-AAUL-01A-21D-A398-05",
                                         "TCGA-RB-A7B8-01A-12D-A33U-05",
                                         "TCGA-LB-A7SX-01A-11D-A33U-05",
                                         "TCGA-IB-A5ST-01A-11D-A32S-05",
                                         "TCGA-3A-A9IC-01A-11D-A38H-05",
                                         "TCGA-HZ-8519-01A-11D-2399-05",
                                         "TCGA-IB-7885-01A-11D-2157-05",
                                         "TCGA-IB-A7LX-01A-12D-A368-05",
                                         "TCGA-F2-6879-01A-11D-2157-05",
                                         "TCGA-3E-AAAZ-01A-11D-A38H-05",
                                         "TCGA-IB-AAUU-01A-11D-A378-05",
                                         "TCGA-FB-AAPY-01A-11D-A40Y-05",
                                         "TCGA-RB-AA9M-01A-11D-A398-05",
                                         "TCGA-FB-A545-01A-11D-A26Q-05",
                                         "TCGA-2J-AABH-01A-21D-A40Y-05",
                                         "TCGA-2J-AABO-01A-21D-A40Y-05",
                                         "TCGA-FB-A4P5-01A-11D-A26Q-05",
                                         "TCGA-YB-A89D-11A-11D-A368-05",
                                         "TCGA-IB-AAUM-01A-11D-A378-05",
                                         "TCGA-IB-A5SO-01A-11D-A32S-05",
                                         "TCGA-IB-7647-01A-11D-2157-05",
                                         "TCGA-S4-A8RP-01A-11D-A368-05",
                                         "TCGA-HV-A5A3-11A-11D-A26Q-05",
                                         "TCGA-2L-AAQA-01A-21D-A38H-05",
                                         "TCGA-M8-A5N4-01A-11D-A26Q-05",
                                         "TCGA-IB-7887-01A-11D-2157-05",
                                         "TCGA-FB-AAPZ-01A-11D-A40Y-05",
                                         "TCGA-FZ-5919-01A-11D-1744-05",
                                         "TCGA-HV-AA8V-01A-11D-A40Y-05",
                                         "TCGA-3A-A9IH-01A-12D-A398-05",
                                         "TCGA-IB-7652-01A-11D-2157-05",
                                         "TCGA-3A-A9IO-01A-11D-A38H-05",
                                         "TCGA-3A-A9IV-01A-11D-A40Y-05",
                                         "TCGA-2J-AABV-01A-12D-A40Y-05",
                                         "TCGA-2J-AAB8-01A-12D-A40Y-05",
                                         "TCGA-F2-A44G-01A-11D-A26Q-05",
                                         "TCGA-HZ-8636-01A-21D-2399-05",
                                         "TCGA-IB-A6UG-01A-32D-A33U-05",
                                         "TCGA-HV-A7OL-01A-11D-A33U-05",
                                         "TCGA-OE-A75W-01A-12D-A32S-05",
                                         "TCGA-IB-8127-01A-11D-2399-05",
                                         "TCGA-FB-A5VM-01A-11D-A32S-05",
                                         "TCGA-IB-7886-01A-11D-2157-05",
                                         "TCGA-3A-A9IU-01A-11D-A398-05",
                                         "TCGA-F2-7276-01A-11D-2157-05",
                                         "TCGA-FB-A7DR-01A-21D-A33U-05",
                                         "TCGA-IB-7649-01A-11D-2157-05",
                                         "TCGA-HV-A5A3-01A-11D-A26Q-05",
                                         "TCGA-3A-A9IN-01A-11D-A398-05"))


#download data 
output_querymethylPAAD <- getResults(query_methylPAAD)
GDCdownload(query_methylPAAD)

#data prepare and assay
PAADDM100 <- GDCprepare(query_methylPAAD, summarizedExperiment = TRUE)
assay(PAADDM100)

#final file download 
write.csv(assay(PAADDM100), file = "TCGA-PAADDNAMethFINAL.csv")