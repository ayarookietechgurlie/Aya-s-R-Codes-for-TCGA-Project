#library download line 
if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
BiocManager::install(c("TCGAbiolinks", "tidyverse", "maftools", "pheatmap", "SummarizedExperiment", "sesameData", "sesame"))

#load installed libraries
library(TCGAbiolinks)
library(tidyverse)
library(maftools)
library(pheatmap)
library(SummarizedExperiment)
library(sesameData)
library(sesame)

#list of projects 
gdcprojects <- getGDCprojects()

#build first query 
query_methylLAML <- GDCquery(project = 'TCGA-LAML',
                             data.category = 'DNA Methylation',
                             platform = 'Illumina Human Methylation 450',
                             access = 'open',
                             data.type = 'Methylation Beta Value',
                             barcode = c("TCGA-AB-2959-03A-01D-0741-05",
                                         "TCGA-AB-2904-03A-01D-0741-05",
                                         "TCGA-AB-2877-03A-01D-0742-05",
                                         "TCGA-AB-2872-03A-01D-0742-05",
                                         "TCGA-AB-2812-03A-01D-0741-05",
                                         "TCGA-AB-2827-03A-01D-0741-05",
                                         "TCGA-AB-2851-03A-01D-0741-05",
                                         "TCGA-AB-2809-03A-01D-0741-05",
                                         "TCGA-AB-2896-03A-01D-0742-05",
                                         "TCGA-AB-2978-03A-01D-0742-05",
                                         "TCGA-AB-2816-03A-01D-0742-05",
                                         "TCGA-AB-2975-03A-01D-0742-05",
                                         "TCGA-AB-2879-03A-01D-0742-05",
                                         "TCGA-AB-2832-03A-01D-0741-05",
                                         "TCGA-AB-2807-03A-01D-0741-05",
                                         "TCGA-AB-2932-03A-01D-0743-05",
                                         "TCGA-AB-2967-03A-01D-0742-05",
                                         "TCGA-AB-3008-03A-01D-0741-05",
                                         "TCGA-AB-2900-03A-01D-0742-05",
                                         "TCGA-AB-2882-03A-01D-0742-05",
                                         "TCGA-AB-2837-03A-01D-0741-05",
                                         "TCGA-AB-2815-03A-01D-0741-05",
                                         "TCGA-AB-2878-03A-01D-0742-05",
                                         "TCGA-AB-2909-03A-01D-0743-05",
                                         "TCGA-AB-2839-03A-01D-0741-05",
                                         "TCGA-AB-2956-03A-01D-0741-05",
                                         "TCGA-AB-2923-03A-01D-0743-05",
                                         "TCGA-AB-2860-03A-01D-0741-05",
                                         "TCGA-AB-2974-03A-01D-0742-05",
                                         "TCGA-AB-2884-03A-01D-0742-05",
                                         "TCGA-AB-2992-03A-01D-0741-05",
                                         "TCGA-AB-2875-03A-01D-0742-05",
                                         "TCGA-AB-2814-03A-01D-0741-05",
                                         "TCGA-AB-3006-03A-01D-0741-05",
                                         "TCGA-AB-3009-03A-01D-0741-05",
                                         "TCGA-AB-2931-03A-01D-0743-05",
                                         "TCGA-AB-2806-03A-01D-0741-05",
                                         "TCGA-AB-2907-03A-01D-0742-05",
                                         "TCGA-AB-2870-03A-01D-0742-05",
                                         "TCGA-AB-2948-03A-01D-0743-05",
                                         "TCGA-AB-2817-03A-01D-0742-05",
                                         "TCGA-AB-2808-03A-01D-0741-05",
                                         "TCGA-AB-2938-03A-01D-0741-05",
                                         "TCGA-AB-2947-03A-01D-0743-05",
                                         "TCGA-AB-2818-03A-01D-0741-05",
                                         "TCGA-AB-2989-03A-01D-0742-05",
                                         "TCGA-AB-2883-03A-01D-0742-05",
                                         "TCGA-AB-2927-03A-01D-0743-05",
                                         "TCGA-AB-2869-03A-01D-0742-05",
                                         "TCGA-AB-3005-03A-01D-0741-05",
                                         "TCGA-AB-2880-03A-01D-0742-05",
                                         "TCGA-AB-2834-03A-01D-0741-05",
                                         "TCGA-AB-3000-03A-01D-0741-05",
                                         "TCGA-AB-2810-03A-01D-0741-05",
                                         "TCGA-AB-2833-03A-01D-0741-05",
                                         "TCGA-AB-2914-03A-01D-0742-05",
                                         "TCGA-AB-2945-03A-01D-0741-05",
                                         "TCGA-AB-2950-03A-01D-0742-05",
                                         "TCGA-AB-2972-03A-01D-0741-05",
                                         "TCGA-AB-2823-03A-01D-0741-05",
                                         "TCGA-AB-2867-03A-01D-0741-05",
                                         "TCGA-AB-2966-03A-01D-0741-05",
                                         "TCGA-AB-2921-03A-01D-0743-05",
                                         "TCGA-AB-2973-03A-01D-0742-05",
                                         "TCGA-AB-2986-03A-01D-0742-05",
                                         "TCGA-AB-2901-03A-01D-0742-05",
                                         "TCGA-AB-2822-03A-01D-0741-05",
                                         "TCGA-AB-2915-03A-01D-0743-05",
                                         "TCGA-AB-2885-03A-01D-0742-05",
                                         "TCGA-AB-2983-03A-01D-0742-05",
                                         "TCGA-AB-2831-03A-01D-0741-05",
                                         "TCGA-AB-2954-03A-01D-0741-05",
                                         "TCGA-AB-3002-03A-01D-0742-05",
                                         "TCGA-AB-2910-03A-01D-0743-05",
                                         "TCGA-AB-2874-03A-01D-0742-05",
                                         "TCGA-AB-2826-03A-01D-0741-05",
                                         "TCGA-AB-2924-03A-01D-0743-05",
                                         "TCGA-AB-2926-03A-01D-0742-05",
                                         "TCGA-AB-2846-03A-01D-0741-05",
                                         "TCGA-AB-2842-03A-01D-0741-05",
                                         "TCGA-AB-2952-03A-01D-0742-05",
                                         "TCGA-AB-2937-03A-01D-0742-05",
                                         "TCGA-AB-2965-03A-01D-0741-05",
                                         "TCGA-AB-2863-03A-01D-0741-05",
                                         "TCGA-AB-2922-03A-01D-0743-05",
                                         "TCGA-AB-2824-03A-01D-0741-05",
                                         "TCGA-AB-2873-03A-01D-0742-05",
                                         "TCGA-AB-2906-03A-01D-0742-05",
                                         "TCGA-AB-2889-03A-01D-0742-05",
                                         "TCGA-AB-2847-03A-01D-0741-05",
                                         "TCGA-AB-3001-03A-01D-0741-05",
                                         "TCGA-AB-2895-03A-01D-0742-05",
                                         "TCGA-AB-2920-03A-01D-0742-05",
                                         "TCGA-AB-2991-03A-01D-0741-05",
                                         "TCGA-AB-2985-03A-01D-0742-05",
                                         "TCGA-AB-2912-03A-01D-0741-05",
                                         "TCGA-AB-2890-03A-01D-0742-05",
                                         "TCGA-AB-2911-03A-01D-0741-05",
                                         "TCGA-AB-2844-03A-01D-0741-05",
                                         "TCGA-AB-2925-03A-01D-0741-05",
                                         "TCGA-AB-2946-03A-01D-0743-05",
                                         "TCGA-AB-2941-03A-01D-0743-05",
                                         "TCGA-AB-2970-03A-01D-0741-05",
                                         "TCGA-AB-2836-03A-01D-0741-05",
                                         "TCGA-AB-2856-03A-01D-0741-05",
                                         "TCGA-AB-2971-03A-01D-0741-05",
                                         "TCGA-AB-2943-03A-01D-0743-05",
                                         "TCGA-AB-2980-03A-01D-0742-05",
                                         "TCGA-AB-2940-03A-01D-0742-05",
                                         "TCGA-AB-2999-03A-01D-0742-05",
                                         "TCGA-AB-2888-03A-01D-0742-05",
                                         "TCGA-AB-2858-03A-01D-0741-05",
                                         "TCGA-AB-2949-03A-01D-0742-05",
                                         "TCGA-AB-2853-03A-01D-0741-05",
                                         "TCGA-AB-2908-03A-01D-0743-05",
                                         "TCGA-AB-2987-03A-01D-0742-05",
                                         "TCGA-AB-2845-03A-01D-0741-05",
                                         "TCGA-AB-2849-03A-01D-0741-05",
                                         "TCGA-AB-2955-03A-01D-0742-05",
                                         "TCGA-AB-2802-03A-01D-0741-05",
                                         "TCGA-AB-2998-03A-01D-0742-05",
                                         "TCGA-AB-2891-03A-01D-0742-05",
                                         "TCGA-AB-2841-03A-01D-0741-05",
                                         "TCGA-AB-2811-03A-01D-0741-05",
                                         "TCGA-AB-2969-03A-01D-0741-05",
                                         "TCGA-AB-2894-03A-01D-0742-05",
                                         "TCGA-AB-2876-03A-01D-0742-05",
                                         "TCGA-AB-2984-03A-01D-0742-05",
                                         "TCGA-AB-2854-03A-01D-0741-05",
                                         "TCGA-AB-2928-03A-01D-0743-05",
                                         "TCGA-AB-2897-03A-01D-0742-05",
                                         "TCGA-AB-2813-03A-01D-0741-05",
                                         "TCGA-AB-2820-03A-01D-0741-05",
                                         "TCGA-AB-3012-03A-01D-0741-05",
                                         "TCGA-AB-2804-03A-01D-0741-05",
                                         "TCGA-AB-2964-03A-01D-0741-05",
                                         "TCGA-AB-2988-03A-01D-0742-05",
                                         "TCGA-AB-2933-03A-01D-0742-05",
                                         "TCGA-AB-2838-03A-01D-0741-05",
                                         "TCGA-AB-2913-03A-01D-0741-05",
                                         "TCGA-AB-2899-03A-01D-0741-05",
                                         "TCGA-AB-2996-03A-01D-0741-05",
                                         "TCGA-AB-2944-03A-01D-0743-05",
                                         "TCGA-AB-2997-03A-01D-0742-05",
                                         "TCGA-AB-2930-03A-01D-0743-05",
                                         "TCGA-AB-2881-03A-01D-0742-05",
                                         "TCGA-AB-2892-03A-01D-0742-05",
                                         "TCGA-AB-2957-03A-01D-0741-05",
                                         "TCGA-AB-2855-03A-01D-0741-05",
                                         "TCGA-AB-2821-03A-01D-0741-05",
                                         "TCGA-AB-2929-03A-01D-0741-05",
                                         "TCGA-AB-2916-03A-01D-0742-05",
                                         "TCGA-AB-2990-03A-01D-0742-05",
                                         "TCGA-AB-2977-03A-01D-0742-05",
                                         "TCGA-AB-2995-03A-01D-0741-05",
                                         "TCGA-AB-2835-03A-01D-0741-05",
                                         "TCGA-AB-2868-03A-01D-0741-05",
                                         "TCGA-AB-3011-03A-01D-0742-05",
                                         "TCGA-AB-2857-03A-01D-0741-05",
                                         "TCGA-AB-2968-03A-01D-0741-05",
                                         "TCGA-AB-2981-03A-01D-0742-05",
                                         "TCGA-AB-2825-03A-01D-0741-05",
                                         "TCGA-AB-2939-03A-01D-0743-05",
                                         "TCGA-AB-2866-03A-01D-0741-05",
                                         "TCGA-AB-2848-03A-01D-0741-05",
                                         "TCGA-AB-2918-03A-01D-0743-05",
                                         "TCGA-AB-2917-03A-01D-0741-05",
                                         "TCGA-AB-2803-03A-01D-0741-05",
                                         "TCGA-AB-3007-03A-01D-0741-05",
                                         "TCGA-AB-2828-03A-01D-0741-05",
                                         "TCGA-AB-2840-03A-01D-0741-05",
                                         "TCGA-AB-2819-03A-01D-0741-05",
                                         "TCGA-AB-2861-03A-01D-0741-05",
                                         "TCGA-AB-2830-03A-01D-0741-05",
                                         "TCGA-AB-2829-03A-01D-0741-05",
                                         "TCGA-AB-2942-03A-01D-0742-05",
                                         "TCGA-AB-2871-03A-01D-0742-05",
                                         "TCGA-AB-2934-03A-01D-0743-05",
                                         "TCGA-AB-2903-03A-01D-0742-05",
                                         "TCGA-AB-2805-03A-01D-0741-05",
                                         "TCGA-AB-2919-03A-01D-0743-05",
                                         "TCGA-AB-2993-03A-01D-0741-05",
                                         "TCGA-AB-2976-03A-01D-0742-05",
                                         "TCGA-AB-2862-03A-01D-0741-05",
                                         "TCGA-AB-2963-03A-01D-0741-05",
                                         "TCGA-AB-2935-03A-01D-0743-05",
                                         "TCGA-AB-2843-03A-01D-0741-05",
                                         "TCGA-AB-2886-03A-01D-0742-05",
                                         "TCGA-AB-2898-03A-01D-0742-05",
                                         "TCGA-AB-2893-03A-01D-0742-05",
                                         "TCGA-AB-2982-03A-01D-0742-05",
                                         "TCGA-AB-2936-03A-01D-0743-05",
                                         "TCGA-AB-2979-03A-01D-0742-05",
                                         "TCGA-AB-2887-03A-01D-0742-05"))


#download data 
output_querymethylLAML <- getResults(query_methylLAML)
GDCdownload(query_methylLAML)

#data prepare and assay
LAMLDM100 <- GDCprepare(query_methylLAML, summarizedExperiment = TRUE)
assay(LAMLDM100)

#final file download 
write.csv(assay(LAMLDM100), file = "TCGA-LAMLDNAMethFINAL.csv")